# Exemple de AutomatizÄƒri cu Filtrare pe JudeÈ›e

Acestea sunt exemple de automatizÄƒri care folosesc filtrarea pe judeÈ›e pentru notificÄƒri personalizate.

## ğŸ“ NotificÄƒri personalizate pentru zona BucureÈ™ti

```yaml
automation:
  - id: alerta_bucuresti_start
    alias: "AlertÄƒ Meteo BucureÈ™ti - Ãnceput"
    description: "Notificare specificÄƒ pentru alertele din BucureÈ™ti È™i Ilfov"
    trigger:
      - platform: state
        entity_id: sensor.alerta_nowcasting
    condition:
      - condition: template
        value_template: "{{ trigger.to_state.state | int > 0 }}"
      # VerificÄƒ dacÄƒ alerta afecteazÄƒ BucureÈ™ti sau Ilfov
      - condition: template
        value_template: >
          {% set counties = state_attr('sensor.alerta_nowcasting', 'counties') %}
          {{ 'BucureÈ™ti' in counties or 'Ilfov' in counties }}
    action:
      - service: notify.mobile_app
        data:
          title: "ğŸŒ©ï¸ ALERTÄ‚ METEO BUCUREÈ˜TI!"
          message: >
            {{ state_attr('sensor.alerta_nowcasting', 'alert_title') }}
            
            Fenomen: {{ state_attr('sensor.alerta_nowcasting', 'phenomena') }}
            
            SfÃ¢rÈ™itul alertei: {{ state_attr('sensor.alerta_nowcasting', 'alert_end') | as_timestamp | timestamp_custom('%H:%M') }}
          data:
            priority: high
            color: "#ff5722"
            tag: bucuresti_weather_alert
```

## ğŸ”ï¸ Automatizare pentru alertÄƒ de munte (ieÈ™ire weekend)

```yaml
automation:
  - id: alerta_weekend_munte
    alias: "AlertÄƒ Meteo Munte - Weekend"
    description: "Notificare vineri seara pentru alertele meteo la munte Ã®n weekend"
    trigger:
      - platform: time
        at: "18:00:00"
    condition:
      # Doar vineri
      - condition: time
        weekday:
          - fri
      # VerificÄƒ dacÄƒ existÄƒ alerte pentru zone montane
      - condition: template
        value_template: >
          {% set counties = ['BraÈ™ov', 'Prahova', 'ArgeÈ™', 'VÃ¢lcea'] %}
          {% set alerts = state_attr('sensor.alerta_nowcasting', 'alerts') %}
          {% set weekend_alerts = namespace(found=false) %}
          {% for alert in alerts %}
            {% if alert.counties is defined %}
              {% for county in alert.counties %}
                {% if county in counties %}
                  {% set weekend_alerts.found = true %}
                {% endif %}
              {% endfor %}
            {% endif %}
          {% endfor %}
          {{ weekend_alerts.found }}
    action:
      - service: notify.mobile_app
        data:
          title: "â›°ï¸ AtenÈ›ie - AlertÄƒ Meteo la Munte!"
          message: >
            ExistÄƒ alerte meteo Ã®n zonele montane pentru acest weekend.
            VerificÄƒ condiÈ›iile Ã®nainte de plecare!
          data:
            actions:
              - action: "VIEW_ALERTS"
                title: "Vezi detalii"
              - action: "DISMISS"
                title: "OK"
```

## ğŸš— AlertÄƒ pentru rutÄƒ de cÄƒlÄƒtorie

```yaml
automation:
  - id: alerta_ruta_calatorie
    alias: "AlertÄƒ Meteo RutÄƒ - BucureÈ™ti â†’ Cluj"
    description: "VerificÄƒ alertele pe traseul BucureÈ™ti - Cluj"
    trigger:
      - platform: state
        entity_id: sensor.alerta_nowcasting
    condition:
      - condition: template
        value_template: "{{ trigger.to_state.state | int > 0 }}"
      # VerificÄƒ dacÄƒ alerta afecteazÄƒ judeÈ›ele de pe traseu
      - condition: template
        value_template: >
          {% set route_counties = ['BucureÈ™ti', 'Ilfov', 'Prahova', 'BraÈ™ov', 'Sibiu', 'Alba', 'Cluj'] %}
          {% set alert_counties = state_attr('sensor.alerta_nowcasting', 'counties') %}
          {% set on_route = namespace(found=false) %}
          {% for county in alert_counties %}
            {% if county in route_counties %}
              {% set on_route.found = true %}
            {% endif %}
          {% endfor %}
          {{ on_route.found }}
    action:
      - service: notify.mobile_app
        data:
          title: "ğŸš— AlertÄƒ pe Traseu BucureÈ™ti â†’ Cluj"
          message: >
            AlertÄƒ meteo pe traseul tÄƒu obiÈ™nuit!
            
            JudeÈ›e afectate: {{ state_attr('sensor.alerta_nowcasting', 'counties') | join(', ') }}
            
            Fenomen: {{ state_attr('sensor.alerta_nowcasting', 'phenomena') }}
            
            AdapteazÄƒ viteza È™i fii precaut!
          data:
            priority: high
```

## ğŸ–ï¸ AlertÄƒ specialÄƒ pentru litoral (vacanÈ›Äƒ)

```yaml
automation:
  - id: alerta_litoral_vacanta
    alias: "AlertÄƒ Meteo Litoral - VacanÈ›Äƒ"
    description: "NotificÄƒ despre alertele meteo la mare cÃ¢nd eÈ™ti Ã®n vacanÈ›Äƒ"
    trigger:
      - platform: state
        entity_id: sensor.alerta_nowcasting
    condition:
      # VerificÄƒ dacÄƒeÈ™ti Ã®n vacanÈ›Äƒ (folosind input_boolean ca exemplu)
      - condition: state
        entity_id: input_boolean.vacanta_litoral
        state: "on"
      # VerificÄƒ alertele pe litoral
      - condition: template
        value_template: >
          {% set coastal_counties = ['ConstanÈ›a', 'Tulcea'] %}
          {% set alert_counties = state_attr('sensor.alerta_nowcasting', 'counties') %}
          {{ coastal_counties | select('in', alert_counties) | list | length > 0 }}
    action:
      - service: notify.mobile_app
        data:
          title: "ğŸŒŠ AlertÄƒ Meteo Litoral!"
          message: >
            AtenÈ›ie la mare!
            
            {{ state_attr('sensor.alerta_nowcasting', 'alert_title') }}
            
            {{ state_attr('sensor.alerta_nowcasting', 'alert_description') }}
          data:
            priority: high
            tag: coastal_alert
            actions:
              - action: "CHECK_BEACH"
                title: "VerificÄƒ plaja"
```

## ğŸ¢ AlertÄƒ pentru multiple locaÈ›ii de afaceri

```yaml
automation:
  - id: alerta_afaceri_multiple
    alias: "AlertÄƒ Meteo Afaceri - Multiple LocaÈ›ii"
    description: "NotificÄƒ pentru alertele Ã®n judeÈ›ele unde ai afaceri"
    trigger:
      - platform: state
        entity_id: sensor.alerta_nowcasting
    condition:
      - condition: template
        value_template: "{{ trigger.to_state.state | int > 0 }}"
    action:
      # IdentificÄƒ care dintre locaÈ›ii sunt afectate
      - service: notify.mobile_app
        data:
          title: "ğŸ¢ AlertÄƒ Meteo - LocaÈ›ii Afaceri"
          message: >
            {% set business_locations = {
              'BucureÈ™ti': 'Sediu Central',
              'Cluj': 'Birou Cluj',
              'TimiÈ™oara': 'ReprezentanÈ›Äƒ Vest',
              'IaÈ™i': 'Birou Moldova'
            } %}
            {% set alert_counties = state_attr('sensor.alerta_nowcasting', 'counties') %}
            {% set affected = namespace(list=[]) %}
            {% for county, location in business_locations.items() %}
              {% if county in alert_counties %}
                {% set affected.list = affected.list + [location] %}
              {% endif %}
            {% endfor %}
            
            Alerte meteo la: {{ affected.list | join(', ') }}
            
            Fenomen: {{ state_attr('sensor.alerta_nowcasting', 'phenomena') }}
            
            Perioada: {{ state_attr('sensor.alerta_nowcasting', 'alert_start') | as_timestamp | timestamp_custom('%H:%M') }} - {{ state_attr('sensor.alerta_nowcasting', 'alert_end') | as_timestamp | timestamp_custom('%H:%M') }}
```

## ğŸŒ¾ AlertÄƒ agricolÄƒ (ferme Ã®n multiple judeÈ›e)

```yaml
automation:
  - id: alerta_agricola
    alias: "AlertÄƒ Meteo AgricolÄƒ"
    description: "NotificÄƒ despre fenomene care afecteazÄƒ culturile"
    trigger:
      - platform: state
        entity_id: sensor.alerta_nowcasting
    condition:
      - condition: template
        value_template: "{{ trigger.to_state.state | int > 0 }}"
      # VerificÄƒ judeÈ›ele cu ferme
      - condition: template
        value_template: >
          {% set farm_counties = ['Teleorman', 'Olt', 'CÄƒlÄƒraÈ™i'] %}
          {% set alert_counties = state_attr('sensor.alerta_nowcasting', 'counties') %}
          {{ farm_counties | select('in', alert_counties) | list | length > 0 }}
      # VerificÄƒ fenomene relevante pentru agriculturÄƒ
      - condition: template
        value_template: >
          {% set phenomena = state_attr('sensor.alerta_nowcasting', 'phenomena') | lower %}
          {{ 'grindina' in phenomena or 'vant' in phenomena or 'polei' in phenomena }}
    action:
      - service: notify.mobile_app
        data:
          title: "ğŸŒ¾ ALERTÄ‚ AGRICOLÄ‚!"
          message: >
            AtenÈ›ie! Fenomen care poate afecta culturile:
            
            {{ state_attr('sensor.alerta_nowcasting', 'phenomena') }}
            
            JudeÈ›e: {{ state_attr('sensor.alerta_nowcasting', 'counties') | join(', ') }}
            
            Ia mÄƒsuri de protecÈ›ie!
          data:
            priority: high
            color: "#ff9800"
```

## ğŸš¨ AlertÄƒ cod roÈ™u pentru zona ta

```yaml
automation:
  - id: alerta_cod_rosu_local
    alias: "AlertÄƒ COD ROÈ˜U - Zona Mea"
    description: "Notificare criticÄƒ pentru cod roÈ™u Ã®n judeÈ›ul tau"
    trigger:
      - platform: state
        entity_id: sensor.alerta_nowcasting
    condition:
      # VerificÄƒ severitate roÈ™ie
      - condition: template
        value_template: "{{ state_attr('sensor.alerta_nowcasting', 'severity') == 'red' }}"
      # VerificÄƒ judeÈ›ul tÄƒu (exemplu: BucureÈ™ti)
      - condition: template
        value_template: >
          {% set my_county = 'BucureÈ™ti' %}
          {% set alert_counties = state_attr('sensor.alerta_nowcasting', 'counties') %}
          {{ my_county in alert_counties }}
    action:
      # Notificare criticÄƒ
      - service: notify.mobile_app
        data:
          title: "ğŸš¨ğŸš¨ COD ROÈ˜U METEO! ğŸš¨ğŸš¨"
          message: >
            PERICOL MAXIM!
            
            {{ state_attr('sensor.alerta_nowcasting', 'alert_title') }}
            
            {{ state_attr('sensor.alerta_nowcasting', 'alert_description') }}
            
            RÄƒmÃ¢i Ã®n siguranÈ›Äƒ!
          data:
            priority: high
            ttl: 0
            channel: Emergency
            color: "#d32f2f"
      
      # Aprinde lumini roÈ™ii intermitent (opÈ›ional)
      - repeat:
          count: 5
          sequence:
            - service: light.turn_on
              target:
                entity_id: light.all_lights
              data:
                brightness: 255
                rgb_color: [255, 0, 0]
            - delay: "00:00:01"
            - service: light.turn_off
              target:
                entity_id: light.all_lights
            - delay: "00:00:01"
      
      # AnunÈ› vocal (opÈ›ional)
      - service: tts.google_translate_say
        data:
          entity_id: media_player.all_speakers
          message: >
            AtenÈ›ie! Cod roÈ™u meteo Ã®n BucureÈ™ti!
            {{ state_attr('sensor.alerta_nowcasting', 'phenomena') }}!
            RÄƒmÃ¢i Ã®n siguranÈ›Äƒ È™i evitÄƒ deplasÄƒrile!
```

## ğŸ’¡ Sfaturi pentru personalizare

### ModificÄƒ judeÈ›ele
ÃnlocuieÈ™te judeÈ›ele din exemple cu cele care te intereseazÄƒ:
```yaml
{% set my_counties = ['JudeÈ›ul1', 'JudeÈ›ul2'] %}
```

### AjusteazÄƒ severitatea
PoÈ›i filtra doar anumite niveluri:
```yaml
# Doar cod portocaliu È™i roÈ™u
condition:
  - condition: template
    value_template: >
      {% set severity = state_attr('sensor.alerta_nowcasting', 'severity') %}
      {{ severity in ['orange', 'red'] }}
```

### FiltreazÄƒ fenomene specifice
```yaml
# Doar pentru grindinÄƒ È™i viscol
condition:
  - condition: template
    value_template: >
      {% set phenomena = state_attr('sensor.alerta_nowcasting', 'phenomena') | lower %}
      {{ 'grindina' in phenomena or 'viscol' in phenomena }}
```

### CombinÄƒ cu alte senzori
```yaml
# NotificÄƒ doar dacÄƒ eÈ™ti acasÄƒ
condition:
  - condition: state
    entity_id: person.nume
    state: 'home'
```

## ğŸ”— ReferinÈ›e

- Vezi [automations.yaml](automations.yaml) pentru automatizÄƒri de bazÄƒ
- Vezi [COUNTIES_EXAMPLES.md](../COUNTIES_EXAMPLES.md) pentru configurÄƒri pe judeÈ›e
- Vezi documentaÈ›ia Home Assistant pentru [Template Conditions](https://www.home-assistant.io/docs/scripts/conditions/#template-condition)
